version: 2
jobs:
  build:
    docker:
      - image: circleci/python:2.7
    working_directory:  ~/RobotFramework
    steps:
      - checkout
      - run: sudo pip install -r requirements.txt
      - run: sudo pip install selenium -U
      - run: sudo apt install libfontconfig
#      - run: wget https://download-installer.cdn.mozilla.net/pub/firefox/releases/64.0.2/linux-x86_64/en-US/firefox-64.0.2.tar.bz2
#      - run: tar xvf firefox*.tar.bz2
#      - run: sudo mv firefox /usr/bin/firefox
#      - run: sudo chown root:root /usr/bin/firefox
#      - run: sudo chmod +x /usr/bin/firefox
##     - run: ./firefox/firefox
#      - run: wget https://github.com/mozilla/geckodriver/releases/download/v0.23.0/geckodriver-v0.23.0-linux64.tar.gz
#      - run: tar -xvzf geckodriver*
#      - run: sudo mv geckodriver /usr/bin/geckodriver
#      - run: sudo chown root:root /usr/bin/geckodriver
#      - run: sudo chmod +x /usr/bin/geckodriver
      - run:  sudo apt -f install
      - run:
          name: Install Chrome
          command: |
            curl -L -o google-chrome.deb https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
            sudo dpkg -i google-chrome.deb
            sudo sed -i 's|HERE/chrome\"|HERE/chrome\" --disable-setuid-sandbox|g' /opt/google/chrome/google-chrome
            rm google-chrome.deb
#      - run:  dpkg -i google-chrome-stable_current_amd64.deb --fix-missing; apt-get -fy install`
      - run:  wget https://chromedriver.storage.googleapis.com/2.45/chromedriver_linux64.zip
      - run:  unzip chromedriver_linux64.zip
      - run:  sudo mv chromedriver /usr/bin/chromedriver
      - run:  sudo chown root:root /usr/bin/chromedriver
      - run:  sudo chmod +x /usr/bin/chromedriver
      - run:  robot -d results  Central/Launch.robot